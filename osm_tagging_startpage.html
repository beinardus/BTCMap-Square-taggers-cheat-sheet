<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>BTCMap — Tagging Start Page</title>
  <style>
    body{font-family:system-ui,-apple-system,Segoe UI,Roboto,'Helvetica Neue',Arial;line-height:1.5;color:#0f172a;background:#f8fafc;padding:24px}
    .container{max-width:980px;margin:0 auto;background:#fff;border-radius:12px;padding:28px;box-shadow:0 6px 24px rgba(2,6,23,0.08)}
    h1{font-size:1.6rem;margin-bottom:6px}
    h2{margin-top:20px;color:#0f172a}
    p{margin:8px 0}
    a{color:#0b5fff;text-decoration:none}
    a:hover{text-decoration:underline}

    /* Improved code block styling */
    pre{
      background:#1e293b;
      color:#f1f5f9;
      padding:14px;
      border-radius:8px;
      overflow:auto;
      font-size:0.95rem;
    }
    code{
      background:#e2e8f0;
      padding:2px 6px;
      border-radius:6px;
    }
    pre code {
      background:transparent;
      padding:0;
      border-radius:0;
      color:#f1f5f9;
    }

    ul{margin:6px 0 12px 20px}
    .meta{font-size:0.95rem;color:#475569;margin-top:8px}
    .note{background:#fff7ed;border-left:4px solid #f59e0b;padding:10px;border-radius:6px;margin-top:12px}
    .footer{margin-top:22px;font-size:0.9rem;color:#64748b}
  </style>
</head>
<body>
  <div class="container">
    <h1>BTCMap — Tagging Start Page</h1>
    <p>A compact start page for tagging and verifying merchants for BTCMap / OpenStreetMap.</p>

    <hr>

    <h2>Resources</h2>
    <ul>
      <li>Open Square issues: <a href="https://gitea.btcmap.org/teambtcmap/btcmap-data/issues?type=all&state=open&milestone=0&project=0&assignee=0&labels=1307" target="_blank" rel="noopener">gitea — open Square issues</a></li>
      <li>Tagging Merchants (BTCMap): <a href="https://gitea.btcmap.org/teambtcmap/btcmap-general/wiki/Tagging-Merchants" target="_blank" rel="noopener">Tagging-Merchants</a></li>
      <li>Verifying Existing Merchants (BTCMap): <a href="https://gitea.btcmap.org/teambtcmap/btcmap-general/wiki/Verifying-Existing-Merchants" target="_blank" rel="noopener">Verifying-Existing-Merchants</a></li>
      <li>OpenStreetMap — Good practice: <a href="https://wiki.openstreetmap.org/wiki/Good_practice" target="_blank" rel="noopener">Good_practice</a></li>
      <li>OpenStreetMap — Tags index: <a href="https://wiki.openstreetmap.org/wiki/Tags" target="_blank" rel="noopener">Tags</a></li>
      <li>Opening hours editor (YoHours): <a href="https://projets.pavie.info/yohours/" target="_blank" rel="noopener">yohours</a></li>
      <li>Opening hours evaluation tool (NL): <a href="https://openingh.openstreetmap.de/evaluation_tool/?lng=nl" target="_blank" rel="noopener">openingh evaluation</a></li>
      <li>OSM Wiki opening hours: <a href="https://wiki.openstreetmap.org/wiki/Key:opening_hours" target="_blank" rel="noopener">Key:opening_hours</a></li>
    </ul>

    <h2>Workflow</h2>
    <ol>
      <li>Pick an open issue from the <a href="https://gitea.btcmap.org/teambtcmap/btcmap-data/issues?type=all&state=open&milestone=0&project=0&assignee=0&labels=1307" target="_blank" rel="noopener">gitea — open Square issues</a></li>
      <li>Check if it is already assigned (except the bot). If so, pick another issue.</li>
      <li>Assign the issue to yourself in Gitea (select from Assignees).</li>
      <li>Research the merchant online to verify its existence and gather information.</li>
      <li>Use the LLM suggestion tool below to help pick the right OSM node type.</li>
      <li>Edit OSM with the appropriate tags, including default BTCMap tags.</li>
      <li>Leave a comment in Gitea with the OSM URL or rejection reason.</li>
      <li>Close the issue in Gitea.</li>
    </ol>

    <h2>Picking the right OSM node type</h2>
    <p>
      Use this form to get suggestions for the appropriate OSM node type based on keywords. Use it when you are unsure which type to choose or when the OSM wizard does not help.
    </p>

    <!-- New: LLM-driven suggestion UI -->
    <div id="llm-sugg" style="margin-top:12px;padding:12px;border-radius:8px;background:#f8fafc;border:1px solid #e6eef8">
      <label style="display:block;font-weight:600;margin-bottom:6px">Keywords</label>
      <input id="llm-keywords" type="text" placeholder="e.g. coffee, takeaway" style="width:100%;padding:10px;border:1px solid #e2e8f0;border-radius:8px">

      <div style="display:flex;gap:8px;margin-top:8px;align-items:center">
        <label style="margin:0;font-size:0.9rem">Provider:</label>
        <select id="llm-provider" style="padding:8px;border-radius:8px">
          <option value="openai">OpenAI (user key)</option>
          <option value="custom">Custom endpoint</option>
        </select>
        <input id="llm-api" type="password" placeholder="API key or URL" style="flex:1;padding:8px;border:1px solid #e2e8f0;border-radius:8px">
      </div>

      <div style="display:flex;gap:8px;margin-top:10px">
        <button id="llm-run" style="padding:8px 12px;border-radius:8px;background:#0b5fff;color:#fff;border:0;cursor:pointer">Suggest (LLM)</button>
        <button id="llm-clear" style="padding:8px 12px;border-radius:8px;background:#f1f5f9;border:1px solid #e2e8f0;cursor:pointer">Clear</button>
        <!-- model fixed to gpt-5-nano -->
        <label style="margin-left:auto;font-size:0.9rem;color:#475569">Model (OpenAI): <input id="llm-model" value="gpt-5-nano" readonly disabled style="margin-left:6px;padding:6px;border-radius:6px;border:1px solid #e2e8f0;opacity:0.85"></label>
      </div>

      <div id="llm-status" style="margin-top:10px;color:#475569;font-size:0.95rem"></div>
      <div id="llm-results" style="margin-top:12px"></div>
      <div style="margin-top:10px;font-size:0.95rem;color:#475569">The LLM is instructed to return JSON only. This UI uses the OpenAI model "gpt-5-nano". For OpenAI, select "OpenAI (user key)" and paste your Bearer key into the API key field. For a self-hosted/proxy endpoint, choose "Custom endpoint" and enter a full URL (POST JSON with the same payload shape as OpenAI's chat completions or a simple proxy that accepts {prompt}).</div>
    </div>

    <h2>Default tagging fields (BTCMap merchants)</h2>
    <p>Switch from grid view to the text view in the OSM editor (<img src="resources/toggle.png" style="vertical-align: middle; margin-left: 2px; margin-right: 2px" />), then add the following tags:</p>
      
    <pre><code id="btcmap-default-tags">check_date=2025-11-14
check_date:currency:XBT=2025-11-14      
currency:XBT=yes
payment:lightning=yes
payment:lightning_contactless=no
payment:onchain=no
payment:lightning:operator=square</code></pre>

    <h2>Socials & contact</h2>
    <p>Check and add contact fields where available:</p>
    <ul>
      <li><code>website=</code></li>
      <li><code>email=</code></li>
      <li><code>phone=</code></li>
      <li><code>contact:instagram=</code></li>
      <li><code>contact:facebook=</code></li>
      <li><code>contact:twitter=</code></li>
      <li><code>contact:youtube=</code></li>
      <li><code>contact:tiktok=</code></li>
    </ul>

    <h2>Labels in Gitea when closing</h2>
    <ul>
      <li><strong>added</strong> — when POI is added</li>
      <li><strong>rejected</strong> — when it does not meet requirements or does not exist</li>
    </ul>

    <h2>Special cases</h2>
    <ul>
      <li>A <code>cafe</code> where only non-alcoholic drinks are served gets the extra tag <code>cuisine=coffee_shop</code> instead of <code>cuisine=bar</code>.</li>
    </ul>

    <h2>Text for new POI OSM</h2>
    <pre><code>#btcmap - Merchant added.</code></pre>

    <h2>Comment in Gitea after processing</h2>
    <pre><code>Added to the map.
&lt;URL here&gt;</code></pre>
    <pre><code>Residential address. No signs of a company. Rejected.</code></pre>

    <div class="note">
      <strong>Note</strong>
      <div class="meta">
        <p>Do not add merchants that provide too little or poor information to be beneficial to the map. Examples include:</p>
        <ul>
          <li>Residential addresses with no signs of a business</li>
          <li>Merchants with no website, social media presence, or contact information</li>
        </ul>
        <p>Provide as much information as possible when tagging, including opening hours, contact details, and social media accounts. Quality over quantity.</p>
      </div>
    </div>

    <p class="footer">Work in Progress: <strong>suggestions are welcome</strong></p>
  </div>

<script src="osm_tagging_startpage.js"></script>
</body>
</html>
